---
phase: 03-cinematic-polish-performance
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - components/Navigation.tsx
  - components/PortfolioCard.tsx
  - components/HeroVideo.tsx
  - components/ScrollIndicator.tsx
  - components/ParallaxSection.tsx
  - app/globals.css
  - app/page.tsx
autonomous: false

must_haves:
  truths:
    - "User hovers over nav links, buttons, portfolio cards and sees smooth animated feedback"
    - "User scrolls past hero and sees parallax depth effect on cinematic sections"
    - "User runs Lighthouse and gets 90+ performance score"
    - "User with prefers-reduced-motion sees no parallax, no vestibular-triggering animations"
  artifacts:
    - path: "components/ParallaxSection.tsx"
      provides: "Scroll-linked parallax wrapper"
      contains: "useScroll"
    - path: "components/PortfolioCard.tsx"
      provides: "Enhanced hover micro-interactions"
      contains: "motion"
    - path: "components/Navigation.tsx"
      provides: "Nav link hover animations"
      contains: "motion"
  key_links:
    - from: "components/ParallaxSection.tsx"
      to: "motion/react"
      via: "useScroll + useTransform"
      pattern: "useScroll|useTransform"
    - from: "components/PortfolioCard.tsx"
      to: "motion/react"
      via: "motion.div hover animations"
      pattern: "whileHover"
---

<objective>
Add micro-interactions to interactive elements, parallax depth effects on scroll, and verify Lighthouse 90+ performance.

Purpose: Delivers the cinematic polish (ANIM-03, ANIM-04) and performance validation (TECH-04) that complete Phase 3.
Output: Polished interactive site with parallax, micro-interactions, and verified performance.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-cinematic-polish-performance/03-RESEARCH.md
@.planning/phases/03-cinematic-polish-performance/03-01-SUMMARY.md
@components/Navigation.tsx
@components/PortfolioCard.tsx
@components/HeroVideo.tsx
@components/ScrollIndicator.tsx
@app/globals.css
@hooks/useReducedMotion.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Micro-interactions and parallax components</name>
  <files>components/Navigation.tsx, components/PortfolioCard.tsx, components/ScrollIndicator.tsx, components/ParallaxSection.tsx, components/HeroVideo.tsx, app/globals.css</files>
  <action>
    **Micro-interactions (ANIM-03):**

    Update components/Navigation.tsx:
    - Add "use client" if not already
    - Import motion from 'motion/react' and useReducedMotion
    - Wrap nav links in motion.a or motion.span with whileHover={{ scale: 1.05, opacity: 0.8 }} and transition={{ duration: 0.2 }}
    - Add subtle underline animation on hover using CSS transform (scaleX from 0 to 1)
    - Reduced motion: no scale, just opacity change

    Update components/PortfolioCard.tsx:
    - Import motion from 'motion/react' and useReducedMotion
    - Replace outer div with motion.div
    - whileHover={{ scale: 1.02, y: -4 }} with transition={{ duration: 0.3, ease: 'easeOut' }}
    - Add subtle box-shadow increase on hover via CSS (not animated via JS — use Tailwind hover:shadow-2xl)
    - Reduced motion: no scale/y transform, just shadow change via CSS

    Update components/ScrollIndicator.tsx:
    - If not already using motion, add gentle bounce animation using motion.div with animate={{ y: [0, 8, 0] }} and transition={{ repeat: Infinity, duration: 1.5, ease: 'easeInOut' }}
    - Reduced motion: static indicator, no bounce

    Add to app/globals.css:
    - Button hover utility: `.btn-hover { transition: transform 0.2s ease, opacity 0.2s ease; } .btn-hover:hover { transform: scale(1.03); }`
    - Under `@media (prefers-reduced-motion: reduce)`: `.btn-hover:hover { transform: none; }`
    - will-change utilities: `.will-change-transform { will-change: transform; }` — apply ONLY to actively animating elements

    **Parallax (ANIM-04):**

    Create components/ParallaxSection.tsx as "use client":
    - Import useScroll, useTransform, motion from 'motion/react'
    - Import useRef from 'react', useReducedMotion from hooks
    - Accept children, speed prop (default 0.3), className prop
    - Use useScroll({ target: ref, offset: ['start end', 'end start'] })
    - Use useTransform(scrollYProgress, [0, 1], [speed * -50, speed * 50]) for y offset
    - Wrap children in motion.div with style={{ y }} (ONLY transform, no other animated props)
    - Reduced motion: render children without motion.div wrapper (no parallax at all)
    - Do NOT add will-change permanently — Motion handles this during animation

    Update components/HeroVideo.tsx:
    - Wrap the hero section content (not the video itself) in ParallaxSection with speed={0.2}
    - This gives a subtle depth effect as user scrolls past hero

    Optionally wrap section headings on homepage in ParallaxSection with speed={0.15} for subtle depth (update app/page.tsx if needed).
  </action>
  <verify>
    `npx next build` passes. Hover over nav links, portfolio cards — see scale/shadow effects. Scroll past hero — subtle parallax shift visible. With prefers-reduced-motion enabled: no parallax, no scale animations.
  </verify>
  <done>All interactive elements have micro-interactions. Parallax depth on hero and key sections. Reduced motion fully respected.</done>
</task>

<task type="auto">
  <name>Task 2: Performance optimization and Lighthouse validation</name>
  <files>app/layout.tsx, app/globals.css</files>
  <action>
    **Performance (TECH-04):**

    Audit and optimize:
    - Ensure Motion is imported via 'motion/react' (tree-shakeable, not legacy 'framer-motion')
    - Consider using LazyMotion + domAnimation from 'motion/react' in layout.tsx if bundle analyzer shows Motion >40KB — wrap the app in `<LazyMotion features={domAnimation}>` to enable code splitting
    - Verify all animations use ONLY transform and opacity (grep for any width/height/top/left animations and remove)
    - Verify will-change is NOT set permanently on any element (only via Motion's automatic handling)
    - Verify no scroll event listeners exist (only IntersectionObserver and Motion's useScroll)
    - Check that Lenis is not causing layout shifts (CLS)

    Run validation:
    - `npx next build` — must pass with 0 errors
    - Start dev server: `npx next start` (production mode)
    - Run Lighthouse: `npx lighthouse http://localhost:3000 --output=json --output=html --output-path=./lighthouse-report --chrome-flags="--headless=new"` (if available)
    - If Lighthouse CLI not available, document manual steps: open Chrome DevTools > Lighthouse > run Performance audit
    - Target: Performance 90+, LCP < 2.5s, CLS < 0.1

    If Lighthouse score is below 90:
    - Check for render-blocking CSS from Lenis
    - Defer non-critical Motion imports
    - Ensure images still use next/image with priority on above-fold
    - Check for excessive DOM nodes from motion.div wrappers
  </action>
  <verify>
    `npx next build` passes. Lighthouse performance score 90+ (or manual verification steps documented). No CLS from animations. All animations GPU-accelerated (transform/opacity only).
  </verify>
  <done>Lighthouse 90+ performance. All animations performant at 60fps. No layout shifts from animation library integration.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete cinematic polish: smooth scrolling (Lenis), page transitions, micro-interactions on hover, parallax depth effects, all with reduced-motion fallbacks, targeting Lighthouse 90+.</what-built>
  <how-to-verify>
    1. Visit http://localhost:3000 — scroll slowly, feel the smooth inertial scrolling (Lenis)
    2. Navigate between /, /work, /services — observe fade+slide page transitions
    3. Hover over nav links — see subtle scale/underline animations
    4. Hover over portfolio cards on /work — see lift + shadow effect
    5. Scroll past hero on homepage — notice subtle parallax depth
    6. Enable prefers-reduced-motion in browser (Chrome DevTools > Rendering > Emulate CSS media feature prefers-reduced-motion) — verify: no smooth scroll, no parallax, simple crossfade transitions, no scale on hover
    7. Run Lighthouse Performance audit (Chrome DevTools > Lighthouse) — target 90+
    8. Check that scroll indicator on hero has gentle bounce animation
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
- `npx next build` completes with 0 errors
- All routes render without errors
- Micro-interactions visible on hover for nav, buttons, portfolio cards
- Parallax depth visible when scrolling past hero
- Page transitions animate between routes
- Lighthouse Performance >= 90, LCP < 2.5s, CLS < 0.1
- prefers-reduced-motion: no parallax, no smooth scroll, crossfade only, no scale animations
</verification>

<success_criteria>
- ANIM-03: Micro-interactions on all interactive elements
- ANIM-04: Parallax depth on hero and key sections
- TECH-04: Lighthouse 90+ performance
- All animations respect prefers-reduced-motion
- No layout shifts, 60fps animations, transform/opacity only
</success_criteria>

<output>
After completion, create `.planning/phases/03-cinematic-polish-performance/03-02-SUMMARY.md`
</output>
