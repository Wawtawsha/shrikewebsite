---
phase: 02-rich-media-core-features
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - components/PortfolioGrid.tsx
  - components/PortfolioCard.tsx
  - components/ProjectLightbox.tsx
  - app/work/page.tsx
  - app/work/[slug]/page.tsx
autonomous: true

must_haves:
  truths:
    - "User can filter portfolio by Photography, Videography, or Software and see only matching projects"
    - "User can click a portfolio item to see full project details in a lightbox"
    - "Portfolio items animate in with scroll-driven reveal as user scrolls"
    - "Each category has distinct visual treatment"
  artifacts:
    - path: "components/PortfolioGrid.tsx"
      provides: "Filterable grid with category tabs"
      contains: "useSearchParams"
    - path: "components/PortfolioCard.tsx"
      provides: "Thumbnail card with cinematic hover overlay"
    - path: "components/ProjectLightbox.tsx"
      provides: "Native dialog-based lightbox"
      contains: "showModal"
    - path: "app/work/page.tsx"
      provides: "Portfolio page with Suspense-wrapped filter grid"
      contains: "Suspense"
    - path: "app/work/[slug]/page.tsx"
      provides: "Individual project detail page"
  key_links:
    - from: "app/work/page.tsx"
      to: "components/PortfolioGrid.tsx"
      via: "Suspense boundary wrapping"
      pattern: "Suspense.*PortfolioGrid"
    - from: "components/PortfolioGrid.tsx"
      to: "lib/projects.ts"
      via: "import project data"
      pattern: "getProjectsByCategory|projects"
    - from: "components/PortfolioCard.tsx"
      to: "components/ProjectLightbox.tsx"
      via: "onClick opens lightbox"
      pattern: "showModal"
---

<objective>
Build the portfolio showcase system with category filtering, cinematic card grid, lightbox detail view, and scroll-driven reveal animations.

Purpose: Deliver PORT-01 through PORT-04 and DSGN-02 — the portfolio is the primary proof of Shrike Media's capabilities.
Output: Working portfolio page with filtering, hover effects, lightbox, scroll reveals, and per-category visual treatments.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-rich-media-core-features/02-RESEARCH.md
@.planning/phases/02-rich-media-core-features/02-01-SUMMARY.md
@types/portfolio.ts
@lib/projects.ts
@components/OptimizedImage.tsx
@hooks/useScrollReveal.ts
@hooks/useReducedMotion.ts
@app/work/page.tsx
@app/work/[slug]/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build PortfolioCard, PortfolioGrid with filtering, and scroll reveals</name>
  <files>components/PortfolioCard.tsx, components/PortfolioGrid.tsx</files>
  <action>
    **components/PortfolioCard.tsx:**
    - "use client" directive
    - Props: `project: Project`, `onSelect: (project: Project) => void`, `index: number` (for stagger)
    - Use useScrollReveal hook — wrap card in ref, apply opacity/translate transition when isVisible
    - Thumbnail area: use OptimizedImage component (or a gradient placeholder div with `bg-gradient-to-br` if no real image)
    - Category-specific visual treatments (DSGN-02):
      - Photography: 4:3 aspect ratio, warm sepia-tinted overlay on hover
      - Videography: 16:9 aspect ratio, blue-tinted overlay on hover
      - Technical/Software: 1:1 aspect ratio, green-tinted overlay on hover
    - Hover overlay: ONLY on devices with hover capability — use `@media (hover: hover)` via Tailwind `hover:` (this is correct by default in Tailwind). On mobile, show project info below the thumbnail always visible instead of hover-only.
    - Hover overlay content: project title, category tag, client name
    - onClick calls onSelect(project)
    - Transition: scale subtle (1.02), overlay fades in, smooth 300ms

    **components/PortfolioGrid.tsx:**
    - "use client" directive
    - CRITICAL: Uses `useSearchParams()` — this component MUST be wrapped in `<Suspense>` by its parent (app/work/page.tsx). Do NOT use useSearchParams in the parent server component.
    - Read `?category=` from search params to determine active filter
    - Filter tabs at top: "All", "Photography", "Videography", "Software" — use `useRouter().push` with search params to update URL (shallow)
    - Active tab styling: bright underline or filled style, inactive tabs muted
    - Grid layout: CSS grid, 3 columns on lg, 2 on md, 1 on sm
    - Map filtered projects to PortfolioCard components
    - Manage lightbox state: `selectedProject` in useState, pass `onSelect` to cards
    - Render ProjectLightbox when selectedProject is set
    - Import projects from lib/projects.ts
    - Animate filter transitions: when category changes, cards should fade/slide in (use CSS transition group or simple key-based remount)
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - Components render without runtime errors
    - Category filter tabs update URL search params
    - Grid is responsive (3/2/1 columns)
  </verify>
  <done>
    - PortfolioCard shows category-specific aspect ratios and hover tints
    - PortfolioGrid reads search params for filtering
    - Filter tabs update URL without full page reload
    - Cards animate in via useScrollReveal
    - Mobile shows info below thumbnails, desktop shows hover overlay
  </done>
</task>

<task type="auto">
  <name>Task 2: Build ProjectLightbox and wire up portfolio pages</name>
  <files>components/ProjectLightbox.tsx, app/work/page.tsx, app/work/[slug]/page.tsx</files>
  <action>
    **components/ProjectLightbox.tsx:**
    - "use client" directive
    - Props: `project: Project | null`, `onClose: () => void`
    - Use native HTML `<dialog>` element (NOT a div with z-index)
    - When project changes to non-null, call `dialogRef.current?.showModal()` (CRITICAL: use showModal() not the open attribute — showModal provides free focus trapping and ESC to close)
    - When closing, call `dialogRef.current?.close()`
    - Listen for dialog's native `close` event to call onClose
    - On open: set `document.body.style.overflow = 'hidden'` to prevent background scroll
    - On close: restore `document.body.style.overflow = ''`
    - Content: project title, description, category badge, client, date, tags
    - Media section: show project images using OptimizedImage, or gradient placeholders
    - Close button: top-right X button, also ESC key works natively with dialog
    - Style the dialog backdrop: `::backdrop` pseudo-element with dark overlay (bg-black/80)
    - Respect useReducedMotion for any open/close animations
    - Clean up overflow style in useEffect cleanup

    **app/work/page.tsx:**
    - Server component (no "use client")
    - Import PortfolioGrid
    - CRITICAL: Wrap PortfolioGrid in `<Suspense fallback={<div>Loading...</div>}>` because PortfolioGrid uses useSearchParams
    - Page title/heading above the grid
    - Generate static metadata export for SEO

    **app/work/[slug]/page.tsx:**
    - Server component
    - Import getProjectBySlug from lib/projects.ts
    - Use `generateStaticParams` to pre-render all project pages
    - Full project detail page (alternative to lightbox for direct URL access / SEO)
    - Show project images, description, metadata
    - "Back to portfolio" link
    - Generate dynamic metadata from project data
    - If slug not found, call notFound()
  </action>
  <verify>
    - `npm run build` passes (confirms Suspense boundary is correct — build would fail without it)
    - Lightbox opens with showModal() and traps focus
    - ESC closes lightbox
    - Body scroll is locked when lightbox is open
    - /work page renders with filter tabs
    - /work/[slug] pages render individual projects
  </verify>
  <done>
    - PORT-01: Portfolio page with category filtering works via URL search params
    - PORT-02: Cinematic hover effects on cards with category-specific treatments (DSGN-02)
    - PORT-03: Lightbox opens on click with full project details, dialog-based with focus trapping
    - PORT-04: Cards animate in with scroll reveal via IntersectionObserver
    - Individual project pages exist at /work/[slug] for SEO
  </done>
</task>

</tasks>

<verification>
- `npm run build` passes (Suspense boundary validated at build time)
- Portfolio page at /work shows all projects in responsive grid
- Clicking category tabs filters projects and updates URL
- Clicking a card opens native dialog lightbox
- ESC closes lightbox, focus returns to triggering card
- Body scroll locked while lightbox open
- /work/photo-project-1 (etc.) renders individual project pages
- Photography cards are 4:3, videography 16:9, software 1:1
- Mobile viewport shows project info below thumbnails (no hover-only content)
</verification>

<success_criteria>
- PORT-01: Category filtering works via search params with Suspense boundary
- PORT-02: Cinematic grid with category-specific hover effects
- PORT-03: Native dialog lightbox with showModal(), focus trapping, ESC close
- PORT-04: Scroll-driven reveal animations via IntersectionObserver
- DSGN-02: Distinct visual treatments per category (aspect ratio + color tint)
</success_criteria>

<output>
After completion, create `.planning/phases/02-rich-media-core-features/02-02-SUMMARY.md`
</output>
