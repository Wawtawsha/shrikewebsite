---
phase: 01-performance-foundation
plan: 02
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - app/layout.tsx
  - app/page.tsx
  - app/work/page.tsx
  - app/work/[slug]/page.tsx
  - app/services/page.tsx
  - app/sitemap.ts
  - app/robots.ts
  - lib/metadata.ts
  - hooks/useReducedMotion.ts
  - components/OptimizedImage.tsx
  - next.config.ts
autonomous: true

must_haves:
  truths:
    - "Search engines can crawl all pages with proper title, description, and Open Graph metadata"
    - "Portfolio detail pages have JSON-LD structured data (schema.org/CreativeWork)"
    - "Site has sitemap.xml and robots.txt accessible at root"
    - "Images use next/image with lazy loading and proper sizes attribute"
    - "User on slow connection sees blur placeholders while images load"
    - "User with prefers-reduced-motion enabled sees no transform/scale animations"
    - "Screen reader announces page landmarks correctly (nav, main, footer)"
  artifacts:
    - path: "lib/metadata.ts"
      provides: "Shared metadata helpers and JSON-LD generator"
    - path: "app/sitemap.ts"
      provides: "Dynamic sitemap generation"
    - path: "app/robots.ts"
      provides: "Robots.txt configuration"
    - path: "hooks/useReducedMotion.ts"
      provides: "Client hook for reduced motion detection"
    - path: "components/OptimizedImage.tsx"
      provides: "Wrapper around next/image with blur placeholder support"
  key_links:
    - from: "app/work/[slug]/page.tsx"
      to: "lib/metadata.ts"
      via: "generateMetadata and JSON-LD helper"
      pattern: "generateMetadata|jsonLd"
    - from: "app/layout.tsx"
      to: "lib/metadata.ts"
      via: "root metadata export"
    - from: "app/sitemap.ts"
      to: "types/portfolio.ts"
      via: "Project type for URL generation"
---

<objective>
Add SEO infrastructure (metadata, Open Graph, JSON-LD, sitemap, robots), accessibility foundations (reduced motion hook, ARIA verification), and image optimization setup.

Purpose: Ensure the site is discoverable by search engines, accessible to all users, and ready for optimized media loading in Phase 2.
Output: Complete SEO metadata on all pages, sitemap.xml, robots.txt, JSON-LD on portfolio pages, reduced motion hook, and optimized image component with blur placeholder support.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-performance-foundation/01-RESEARCH.md
@.planning/phases/01-performance-foundation/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: SEO metadata, sitemap, robots, and JSON-LD structured data</name>
  <files>
    lib/metadata.ts, app/layout.tsx, app/page.tsx, app/work/page.tsx, app/work/[slug]/page.tsx, app/services/page.tsx, app/sitemap.ts, app/robots.ts
  </files>
  <action>
    1. Create `lib/metadata.ts` with:
       - `SITE_URL` constant: 'https://shrikemedia.com' (or env var)
       - `siteMetadata` object with default title template, description, OG image
       - `generateJsonLd(project: Project)` function returning schema.org/CreativeWork JSON-LD object:
         ```typescript
         {
           '@context': 'https://schema.org',
           '@type': 'CreativeWork',
           name: project.title,
           description: project.description,
           image: project.thumbnail,
           url: `${SITE_URL}/work/${project.slug}`,
           author: { '@type': 'Organization', name: 'Shrike Media', url: SITE_URL },
           datePublished: project.publishedAt,
           keywords: project.tags.join(', '),
         }
         ```
       - `generateOrganizationJsonLd()` for homepage Organization schema

    2. Update `app/layout.tsx` metadata export:
       - metadataBase: new URL(SITE_URL)
       - title: { default: 'Shrike Media | Premium Video Production', template: '%s | Shrike Media' }
       - description, openGraph (with og-image.jpg placeholder), twitter card
       - robots: { index: true, follow: true }

    3. Add metadata exports to each page:
       - `app/page.tsx`: title 'Shrike Media | Premium Video Production' (default)
       - `app/work/page.tsx`: title 'Our Work', description about portfolio
       - `app/services/page.tsx`: title 'Services', description about services
       - `app/work/[slug]/page.tsx`: `generateMetadata` async function that awaits params, returns dynamic title/description/OG. Add JSON-LD script tag in page body using `generateJsonLd()`.

    4. Create `app/sitemap.ts`:
       ```typescript
       import type { MetadataRoute } from 'next'

       export default function sitemap(): MetadataRoute.Sitemap {
         const baseUrl = 'https://shrikemedia.com'
         return [
           { url: baseUrl, lastModified: new Date(), changeFrequency: 'monthly', priority: 1 },
           { url: `${baseUrl}/work`, lastModified: new Date(), changeFrequency: 'weekly', priority: 0.8 },
           { url: `${baseUrl}/services`, lastModified: new Date(), changeFrequency: 'monthly', priority: 0.7 },
         ]
       }
       ```

    5. Create `app/robots.ts`:
       ```typescript
       import type { MetadataRoute } from 'next'

       export default function robots(): MetadataRoute.Robots {
         return {
           rules: { userAgent: '*', allow: '/' },
           sitemap: 'https://shrikemedia.com/sitemap.xml',
         }
       }
       ```
  </action>
  <verify>
    1. `npm run build` passes
    2. `npm run dev` -- view page source on each route, confirm `<title>`, `<meta>` OG tags present
    3. Visit /sitemap.xml -- returns valid XML
    4. Visit /robots.txt -- returns valid robots content
    5. Visit /work/test-slug -- page source contains `<script type="application/ld+json">`
  </verify>
  <done>
    Every page has proper title, description, Open Graph metadata. Sitemap and robots.txt are accessible. Portfolio detail pages include JSON-LD structured data.
  </done>
</task>

<task type="auto">
  <name>Task 2: Accessibility hook, optimized image component with blur placeholders, and a11y audit</name>
  <files>
    hooks/useReducedMotion.ts, components/OptimizedImage.tsx, next.config.ts
  </files>
  <action>
    1. Create `hooks/useReducedMotion.ts`:
       ```typescript
       'use client'
       import { useEffect, useState } from 'react'

       export function useReducedMotion(): boolean {
         const [prefersReducedMotion, setPrefersReducedMotion] = useState(false)

         useEffect(() => {
           const mq = window.matchMedia('(prefers-reduced-motion: reduce)')
           setPrefersReducedMotion(mq.matches)
           const handler = (e: MediaQueryListEvent) => setPrefersReducedMotion(e.matches)
           mq.addEventListener('change', handler)
           return () => mq.removeEventListener('change', handler)
         }, [])

         return prefersReducedMotion
       }
       ```

    2. Create `components/OptimizedImage.tsx` as a thin wrapper around next/image:
       - Accept all next/image props plus optional `blurColor` (defaults to a neutral dark gray)
       - Default loading="lazy", sizes prop required
       - Apply dark bg-secondary as fallback background on container
       - Wire up `placeholder="blur"` and `blurDataURL` by default:
         - Generate a tiny inline base64 data URI from the `blurColor` prop. Use a 1x1 pixel PNG encoded as base64. Example helper:
           ```typescript
           function generateBlurPlaceholder(color: string = '#1a1a2e'): string {
             // 1x1 pixel PNG with the given color, base64-encoded
             // For scaffold cards, use static precomputed base64 strings
             return `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==`
           }
           ```
         - Allow callers to pass their own `blurDataURL` to override the default
       - If `blurDataURL` is explicitly passed, use it directly; otherwise generate from `blurColor`
       - This ensures blur placeholders work end-to-end now with scaffold data, and real base64 blur hashes from plaiceholder can be swapped in during Phase 2
       - Server Component (no 'use client' needed since next/image is a server component)

    3. Update `next.config.ts` to configure image optimization:
       ```typescript
       import type { NextConfig } from 'next'
       const nextConfig: NextConfig = {
         images: {
           formats: ['image/avif', 'image/webp'],
         },
       }
       export default nextConfig
       ```
       This tells Next.js to serve AVIF first (smaller), WebP as fallback.

    4. Ensure semantic HTML and accessibility across all scaffold pages:
       - Verify all pages use semantic elements: nav, main, footer, section, article, h1-h3
       - Confirm skip-to-content link exists in layout and targets #main-content
       - Confirm all images have alt text
       - Confirm all interactive elements are keyboard accessible
       - Confirm the globals.css prefers-reduced-motion rule from Plan 01 is in place
       - Fix any missing semantic elements or ARIA landmarks found during review
  </action>
  <verify>
    1. `npm run build` passes
    2. `hooks/useReducedMotion.ts` exists and exports the hook
    3. `components/OptimizedImage.tsx` exists, wraps next/image, and passes `placeholder="blur"` + `blurDataURL` by default
    4. Render OptimizedImage in a page -- inspect HTML and confirm the blur placeholder data URI is present in the rendered `<img>` tag
    5. `next.config.ts` includes `images.formats: ['image/avif', 'image/webp']`
    6. Tab through entire site (/, /work, /services) -- all links/buttons reachable, skip link works
    7. Accessibility checklist:
       - All pages use semantic HTML (nav, main, footer, section, article, h1-h3)
       - Skip-to-content link exists and targets #main-content
       - All images have alt text
       - Color contrast: text-primary on bg-primary meets WCAG AA (4.5:1 ratio)
  </verify>
  <done>
    Reduced motion hook ready for Phase 3 animations. OptimizedImage component renders blur placeholders using inline base64 data URIs, ready for real blur hashes in Phase 2. Image optimization configured for AVIF/WebP. All pages pass basic accessibility checks (keyboard nav, ARIA landmarks, semantic HTML, skip link).
  </done>
</task>

</tasks>

<verification>
- Every page returns proper `<title>` and OG meta tags in HTML source
- /sitemap.xml returns valid sitemap
- /robots.txt returns valid robots
- /work/[slug] pages include JSON-LD script tag
- `next.config.ts` has AVIF + WebP image formats
- OptimizedImage renders with blur placeholder data URI visible in HTML
- Tab navigation works across all pages without getting trapped
- Skip-to-content link visible on focus, jumps to main content
- prefers-reduced-motion CSS rule eliminates animations
- `npm run build` passes with 0 errors
</verification>

<success_criteria>
- Search engines can index all pages with proper metadata and structured data
- Sitemap and robots.txt accessible at site root
- Image optimization pipeline configured (AVIF first, WebP fallback)
- Blur placeholders render on OptimizedImage components using inline base64 data URIs
- Accessibility foundations in place: reduced motion hook, ARIA landmarks, keyboard nav, skip link
- All pages have unique titles and descriptions
</success_criteria>

<output>
After completion, create `.planning/phases/01-performance-foundation/01-02-SUMMARY.md`
</output>
